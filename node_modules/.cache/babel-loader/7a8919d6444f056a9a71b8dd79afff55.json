{"ast":null,"code":"import _asyncToGenerator from\"/Users/javier/Documents/BudgetFrontend/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/javier/Documents/BudgetFrontend/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/javier/Documents/BudgetFrontend/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useContext}from\"react\";import{Form,Button,InputGroup,FormControl}from\"react-bootstrap\";import AuthContext from\"../../Context/AuthContext\";import{useNavigate}from\"react-router-dom\";import moment from\"moment\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CreateEditGoalForm=function CreateEditGoalForm(_ref){var creating=_ref.creating,title=_ref.title,amount=_ref.amount,saved=_ref.saved,idGoal=_ref.idGoal;var isCreating=creating;var _useContext=useContext(AuthContext),authTokens=_useContext.authTokens,logoutUser=_useContext.logoutUser;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),validated=_useState2[0],setValidated=_useState2[1];var createTransactionForGoal=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var amountToSave,transacWay,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:amountToSave=event.target.elements.formSaved.value;transacWay=\"O\";if(!creating){if(parseFloat(event.target.elements.formSaved.value)>parseFloat(saved)){amountToSave=event.target.elements.formSaved.value-saved;}else if(parseFloat(event.target.elements.formSaved.value)<parseFloat(saved)){amountToSave=saved-event.target.elements.formSaved.value;transacWay=\"I\";}}_context.next=5;return fetch(\"http://127.0.0.1:8000/transactions/create/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+String(authTokens.access)},body:JSON.stringify({amount:amountToSave,category:\"goal\",receiver:title,transaction_way:transacWay,date:event.target.elements.formDate.value})});case 5:response=_context.sent;if(response.statusText===\"Unauthorized\"){logoutUser();}return _context.abrupt(\"return\");case 8:case\"end\":return _context.stop();}}},_callee);}));return function createTransactionForGoal(_x){return _ref2.apply(this,arguments);};}();var createGoal=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"http://127.0.0.1:8000/goals/create/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+String(authTokens.access)},body:JSON.stringify({amount:event.target.elements.formAmount.value,saved:event.target.elements.formSaved.value,title:event.target.elements.formReceiver.value})});case 2:response=_context2.sent;if(!(response.status===200)){_context2.next=8;break;}_context2.next=6;return createTransactionForGoal(event);case 6:_context2.next=9;break;case 8:if(response.statusText===\"Unauthorized\"){logoutUser();}case 9:window.location.reload();case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function createGoal(_x2){return _ref3.apply(this,arguments);};}();var editGoal=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(parseFloat(event.target.elements.formSaved.value)>parseFloat(event.target.elements.formAmount.value))){_context3.next=3;break;}alert(\"Saved can't be greater than amount\");return _context3.abrupt(\"return\");case 3:_context3.next=5;return fetch(\"http://127.0.0.1:8000/goals/\".concat(idGoal,\"/update/\"),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+String(authTokens.access)},body:JSON.stringify({amount:event.target.elements.formAmount.value,saved:event.target.elements.formSaved.value,title:title})});case 5:response=_context3.sent;if(!(response.status===200)){_context3.next=12;break;}if(!(event.target.elements.formSaved.value!==saved||event.target.elements.formAmount.value!==amount)){_context3.next=10;break;}_context3.next=10;return createTransactionForGoal(event);case 10:_context3.next=13;break;case 12:if(response.statusText===\"Unauthorized\"){logoutUser();}case 13:window.location.reload();case 14:case\"end\":return _context3.stop();}}},_callee3);}));return function editGoal(_x3){return _ref4.apply(this,arguments);};}();var handleSubmit=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(event){var form;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:form=event.currentTarget;if(form.checkValidity()===false){event.preventDefault();event.stopPropagation();alert(\"No changes detected\");}else{if(isCreating){createGoal(event);}else{editGoal(event);event.preventDefault();event.stopPropagation();}}setValidated(true);handleCloseForm();case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function handleSubmit(_x4){return _ref5.apply(this,arguments);};}();var handleCloseForm=function handleCloseForm(event){//event.preventDefault();\n//event.stopPropagation();\nsetValidated(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"w-100\",children:/*#__PURE__*/_jsxs(Form,{noValidate:true,validated:validated,onSubmit:function onSubmit(e){return handleSubmit(e);},onReset:function onReset(e){return handleCloseForm(e);},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formReceiver\",children:[!isCreating?/*#__PURE__*/_jsx(\"div\",{}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Goal Title \"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"text\",placeholder:\"Enter the title\"})]}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please enter a receiver.\"}),/*#__PURE__*/_jsx(Form.Text,{})]})}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formAmount\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Amount\"}),/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(InputGroup.Text,{children:\"$\"}),!isCreating?/*#__PURE__*/_jsx(FormControl,{required:true,type:\"number\",min:\"0.00\",max:\"10000.00\",step:\"0.01\",placeholder:\"Enter amount\",defaultValue:amount}):/*#__PURE__*/_jsx(FormControl,{required:true,type:\"number\",min:\"0.00\",max:\"10000.00\",step:\"0.01\",placeholder:\"Enter amount\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please enter a amount.\"})]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formSaved\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Saved\"}),/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(InputGroup.Text,{children:\"$\"}),!isCreating?/*#__PURE__*/_jsx(FormControl,{required:true,type:\"number\",min:\"0.00\",max:\"10000.00\",step:\"0.01\",placeholder:\"Enter amount saved\",defaultValue:saved}):/*#__PURE__*/_jsx(FormControl,{required:true,type:\"number\",min:\"0.00\",max:\"10000.00\",step:\"0.01\",placeholder:\"Enter amount saved\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please enter a amount saved.\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formDate\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date \"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"date\",max:moment().format(\"YYYY-MM-DD\"),placeholder:\"Enter the date\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please choose a date.\"}),/*#__PURE__*/_jsx(Form.Text,{})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(Button,{size:\"md\",variant:\"primary\",type:\"submit\",children:isCreating?\"Add Goal\":\"Edit Goal\"})})})]})});};export default CreateEditGoalForm;","map":{"version":3,"sources":["/Users/javier/Documents/BudgetFrontend/frontend/src/Components/Forms/CreateEditGoalForm.js"],"names":["React","useState","useContext","Form","Button","InputGroup","FormControl","AuthContext","useNavigate","moment","CreateEditGoalForm","creating","title","amount","saved","idGoal","isCreating","authTokens","logoutUser","validated","setValidated","createTransactionForGoal","event","amountToSave","target","elements","formSaved","value","transacWay","parseFloat","fetch","method","headers","Authorization","String","access","body","JSON","stringify","category","receiver","transaction_way","date","formDate","response","statusText","createGoal","formAmount","formReceiver","status","window","location","reload","editGoal","alert","handleSubmit","form","currentTarget","checkValidity","preventDefault","stopPropagation","handleCloseForm","e","format"],"mappings":"kZAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,UAA1B,KAA4C,OAA5C,CACA,OAASC,IAAT,CAAeC,MAAf,CAAuBC,UAAvB,CAAmCC,WAAnC,KAAsD,iBAAtD,CACA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,C,wFAEA,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,MAAgD,IAA7CC,CAAAA,QAA6C,MAA7CA,QAA6C,CAAnCC,KAAmC,MAAnCA,KAAmC,CAA5BC,MAA4B,MAA5BA,MAA4B,CAApBC,KAAoB,MAApBA,KAAoB,CAAbC,MAAa,MAAbA,MAAa,CACzE,GAAMC,CAAAA,UAAU,CAAGL,QAAnB,CACA,gBAAiCT,UAAU,CAACK,WAAD,CAA3C,CAAMU,UAAN,aAAMA,UAAN,CAAkBC,UAAlB,aAAkBA,UAAlB,CAEA,cAAkCjB,QAAQ,CAAC,KAAD,CAA1C,wCAAOkB,SAAP,eAAkBC,YAAlB,eAEA,GAAMC,CAAAA,wBAAwB,2FAAG,iBAAOC,KAAP,uJAC3BC,YAD2B,CACZD,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KADpB,CAE3BC,UAF2B,CAEd,GAFc,CAG/B,GAAI,CAACjB,QAAL,CAAe,CACb,GACEkB,UAAU,CAACP,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KAAjC,CAAV,CAAoDE,UAAU,CAACf,KAAD,CADhE,CAEE,CACAS,YAAY,CAAGD,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KAAhC,CAAwCb,KAAvD,CACD,CAJD,IAIO,IACLe,UAAU,CAACP,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KAAjC,CAAV,CAAoDE,UAAU,CAACf,KAAD,CADzD,CAEL,CACAS,YAAY,CAAGT,KAAK,CAAGQ,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KAAvD,CACAC,UAAU,CAAG,GAAb,CACD,CACF,CAd8B,sBAeVE,CAAAA,KAAK,CAAC,4CAAD,CAA+C,CACvEC,MAAM,CAAE,MAD+D,CAEvEC,OAAO,CAAE,CACP,eAAgB,kBADT,CAEPC,aAAa,CAAE,UAAYC,MAAM,CAACjB,UAAU,CAACkB,MAAZ,CAF1B,CAF8D,CAMvEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBzB,MAAM,CAAEU,YADW,CAEnBgB,QAAQ,CAAE,MAFS,CAGnBC,QAAQ,CAAE5B,KAHS,CAInB6B,eAAe,CAAEb,UAJE,CAKnBc,IAAI,CAAEpB,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBkB,QAAtB,CAA+BhB,KALlB,CAAf,CANiE,CAA/C,CAfK,QAe3BiB,QAf2B,eA6B/B,GAAIA,QAAQ,CAACC,UAAT,GAAwB,cAA5B,CAA4C,CAC1C3B,UAAU,GACX,CA/B8B,uFAAH,kBAAxBG,CAAAA,wBAAwB,6CAA9B,CAmCA,GAAMyB,CAAAA,UAAU,2FAAG,kBAAOxB,KAAP,0JACIQ,CAAAA,KAAK,CAAC,qCAAD,CAAwC,CAChEC,MAAM,CAAE,MADwD,CAEhEC,OAAO,CAAE,CACP,eAAgB,kBADT,CAEPC,aAAa,CAAE,UAAYC,MAAM,CAACjB,UAAU,CAACkB,MAAZ,CAF1B,CAFuD,CAMhEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBzB,MAAM,CAAES,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBsB,UAAtB,CAAiCpB,KADtB,CAEnBb,KAAK,CAAEQ,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KAFpB,CAGnBf,KAAK,CAAEU,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBuB,YAAtB,CAAmCrB,KAHvB,CAAf,CAN0D,CAAxC,CADT,QACbiB,QADa,qBAabA,QAAQ,CAACK,MAAT,GAAoB,GAbP,kDAeT5B,CAAAA,wBAAwB,CAACC,KAAD,CAff,sCAgBV,GAAIsB,QAAQ,CAACC,UAAT,GAAwB,cAA5B,CAA4C,CACjD3B,UAAU,GACX,CAlBgB,OAmBjBgC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAnBiB,yDAAH,kBAAVN,CAAAA,UAAU,8CAAhB,CAsBA,GAAMO,CAAAA,QAAQ,2FAAG,kBAAO/B,KAAP,wIAEbO,UAAU,CAACP,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KAAjC,CAAV,CACAE,UAAU,CAACP,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBsB,UAAtB,CAAiCpB,KAAlC,CAHG,2BAKb2B,KAAK,CAAC,oCAAD,CAAL,CALa,gEAQMxB,CAAAA,KAAK,uCACOf,MADP,aAExB,CACEgB,MAAM,CAAE,KADV,CAEEC,OAAO,CAAE,CACP,eAAgB,kBADT,CAEPC,aAAa,CAAE,UAAYC,MAAM,CAACjB,UAAU,CAACkB,MAAZ,CAF1B,CAFX,CAMEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBzB,MAAM,CAAES,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBsB,UAAtB,CAAiCpB,KADtB,CAEnBb,KAAK,CAAEQ,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KAFpB,CAGnBf,KAAK,CAAEA,KAHY,CAAf,CANR,CAFwB,CARX,QAQXgC,QARW,qBAuBXA,QAAQ,CAACK,MAAT,GAAoB,GAvBT,iCA0BX3B,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBC,SAAtB,CAAgCC,KAAhC,GAA0Cb,KAA1C,EACAQ,KAAK,CAACE,MAAN,CAAaC,QAAb,CAAsBsB,UAAtB,CAAiCpB,KAAjC,GAA2Cd,MA3BhC,oDA6BLQ,CAAAA,wBAAwB,CAACC,KAAD,CA7BnB,yCA+BR,GAAIsB,QAAQ,CAACC,UAAT,GAAwB,cAA5B,CAA4C,CACjD3B,UAAU,GACX,CAjCc,QAkCfgC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAlCe,yDAAH,kBAARC,CAAAA,QAAQ,8CAAd,CAqCA,GAAME,CAAAA,YAAY,2FAAG,kBAAOjC,KAAP,+HACbkC,IADa,CACNlC,KAAK,CAACmC,aADA,CAEnB,GAAID,IAAI,CAACE,aAAL,KAAyB,KAA7B,CAAoC,CAClCpC,KAAK,CAACqC,cAAN,GACArC,KAAK,CAACsC,eAAN,GACAN,KAAK,CAAC,qBAAD,CAAL,CACD,CAJD,IAIO,CACL,GAAItC,UAAJ,CAAgB,CACd8B,UAAU,CAACxB,KAAD,CAAV,CACD,CAFD,IAEO,CACL+B,QAAQ,CAAC/B,KAAD,CAAR,CACAA,KAAK,CAACqC,cAAN,GACArC,KAAK,CAACsC,eAAN,GACD,CACF,CACDxC,YAAY,CAAC,IAAD,CAAZ,CACAyC,eAAe,GAhBI,wDAAH,kBAAZN,CAAAA,YAAY,8CAAlB,CAmBA,GAAMM,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACvC,KAAD,CAAW,CACjC;AACA;AACAF,YAAY,CAAC,KAAD,CAAZ,CACD,CAJD,CAMA,mBACE,YAAK,SAAS,CAAC,OAAf,uBACE,MAAC,IAAD,EACE,UAAU,KADZ,CAEE,SAAS,CAAED,SAFb,CAGE,QAAQ,CAAE,kBAAC2C,CAAD,QAAOP,CAAAA,YAAY,CAACO,CAAD,CAAnB,EAHZ,CAIE,OAAO,CAAE,iBAACA,CAAD,QAAOD,CAAAA,eAAe,CAACC,CAAD,CAAtB,EAJX,wBAME,kCACE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,cAAvC,WACG,CAAC9C,UAAD,cACC,cADD,cAGC,oCACE,KAAC,IAAD,CAAM,KAAN,0BADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,MAFP,CAGE,WAAW,CAAC,iBAHd,EAFF,GAJJ,cAcE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,sCAdF,cAiBE,KAAC,IAAD,CAAM,IAAN,IAjBF,GADF,EANF,cA2BE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,YAAvC,wBACE,KAAC,IAAD,CAAM,KAAN,qBADF,cAEE,MAAC,UAAD,EAAY,SAAS,CAAC,MAAtB,wBACE,KAAC,UAAD,CAAY,IAAZ,gBADF,CAEG,CAACA,UAAD,cACC,KAAC,WAAD,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,QAFP,CAGE,GAAG,CAAC,MAHN,CAIE,GAAG,CAAC,UAJN,CAKE,IAAI,CAAC,MALP,CAME,WAAW,CAAC,cANd,CAOE,YAAY,CAAEH,MAPhB,EADD,cAWC,KAAC,WAAD,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,QAFP,CAGE,GAAG,CAAC,MAHN,CAIE,GAAG,CAAC,UAJN,CAKE,IAAI,CAAC,MALP,CAME,WAAW,CAAC,cANd,EAbJ,cAuBE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,oCAvBF,GAFF,GA3BF,cAyDE,kCACE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,WAAvC,wBACE,KAAC,IAAD,CAAM,KAAN,oBADF,cAEE,MAAC,UAAD,EAAY,SAAS,CAAC,MAAtB,wBACE,KAAC,UAAD,CAAY,IAAZ,gBADF,CAEG,CAACG,UAAD,cACC,KAAC,WAAD,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,QAFP,CAGE,GAAG,CAAC,MAHN,CAIE,GAAG,CAAC,UAJN,CAKE,IAAI,CAAC,MALP,CAME,WAAW,CAAC,oBANd,CAOE,YAAY,CAAEF,KAPhB,EADD,cAWC,KAAC,WAAD,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,QAFP,CAGE,GAAG,CAAC,MAHN,CAIE,GAAG,CAAC,UAJN,CAKE,IAAI,CAAC,MALP,CAME,WAAW,CAAC,oBANd,EAbJ,cAuBE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,0CAvBF,GAFF,GADF,EAzDF,cAyFE,kCACE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,UAAvC,wBACE,KAAC,IAAD,CAAM,KAAN,oBADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,MAFP,CAGE,GAAG,CAAEL,MAAM,GAAGsD,MAAT,CAAgB,YAAhB,CAHP,CAIE,WAAW,CAAC,gBAJd,EAFF,cAQE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,mCARF,cAWE,KAAC,IAAD,CAAM,IAAN,IAXF,GADF,EAzFF,cAwGE,kCACE,YAAK,SAAS,CAAC,+BAAf,uBACE,KAAC,MAAD,EAAQ,IAAI,CAAC,IAAb,CAAkB,OAAO,CAAC,SAA1B,CAAoC,IAAI,CAAC,QAAzC,UACG/C,UAAU,CAAG,UAAH,CAAgB,WAD7B,EADF,EADF,EAxGF,GADF,EADF,CAoHD,CAjPD,CAmPA,cAAeN,CAAAA,kBAAf","sourcesContent":["import React, { useState, useContext } from \"react\";\nimport { Form, Button, InputGroup, FormControl } from \"react-bootstrap\";\nimport AuthContext from \"../../Context/AuthContext\";\nimport { useNavigate } from \"react-router-dom\";\nimport moment from \"moment\";\n\nconst CreateEditGoalForm = ({ creating, title, amount, saved, idGoal }) => {\n  const isCreating = creating;\n  let { authTokens, logoutUser } = useContext(AuthContext);\n\n  const [validated, setValidated] = useState(false);\n\n  const createTransactionForGoal = async (event) => {\n    let amountToSave = event.target.elements.formSaved.value;\n    let transacWay = \"O\";\n    if (!creating) {\n      if (\n        parseFloat(event.target.elements.formSaved.value) > parseFloat(saved)\n      ) {\n        amountToSave = event.target.elements.formSaved.value - saved;\n      } else if (\n        parseFloat(event.target.elements.formSaved.value) < parseFloat(saved)\n      ) {\n        amountToSave = saved - event.target.elements.formSaved.value;\n        transacWay = \"I\";\n      }\n    }\n    let response = await fetch(\"http://127.0.0.1:8000/transactions/create/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + String(authTokens.access),\n      },\n      body: JSON.stringify({\n        amount: amountToSave,\n        category: \"goal\",\n        receiver: title,\n        transaction_way: transacWay,\n        date: event.target.elements.formDate.value,\n      }),\n    });\n    if (response.statusText === \"Unauthorized\") {\n      logoutUser();\n    }\n    return;\n  };\n\n  const createGoal = async (event) => {\n    let response = await fetch(\"http://127.0.0.1:8000/goals/create/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + String(authTokens.access),\n      },\n      body: JSON.stringify({\n        amount: event.target.elements.formAmount.value,\n        saved: event.target.elements.formSaved.value,\n        title: event.target.elements.formReceiver.value,\n      }),\n    });\n    if (response.status === 200) {\n      //history(\"/\");\n      await createTransactionForGoal(event);\n    } else if (response.statusText === \"Unauthorized\") {\n      logoutUser();\n    }\n    window.location.reload();\n  };\n\n  const editGoal = async (event) => {\n    if (\n      parseFloat(event.target.elements.formSaved.value) >\n      parseFloat(event.target.elements.formAmount.value)\n    ) {\n      alert(\"Saved can't be greater than amount\");\n      return;\n    }\n    let response = await fetch(\n      `http://127.0.0.1:8000/goals/${idGoal}/update/`,\n      {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + String(authTokens.access),\n        },\n        body: JSON.stringify({\n          amount: event.target.elements.formAmount.value,\n          saved: event.target.elements.formSaved.value,\n          title: title,\n        }),\n      }\n    );\n    if (response.status === 200) {\n      //history(\"/\");\n      if (\n        event.target.elements.formSaved.value !== saved ||\n        event.target.elements.formAmount.value !== amount\n      ) {\n        await createTransactionForGoal(event);\n      }\n    } else if (response.statusText === \"Unauthorized\") {\n      logoutUser();\n    }\n    window.location.reload();\n  };\n\n  const handleSubmit = async (event) => {\n    const form = event.currentTarget;\n    if (form.checkValidity() === false) {\n      event.preventDefault();\n      event.stopPropagation();\n      alert(\"No changes detected\");\n    } else {\n      if (isCreating) {\n        createGoal(event);\n      } else {\n        editGoal(event);\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }\n    setValidated(true);\n    handleCloseForm();\n  };\n\n  const handleCloseForm = (event) => {\n    //event.preventDefault();\n    //event.stopPropagation();\n    setValidated(false);\n  };\n\n  return (\n    <div className=\"w-100\">\n      <Form\n        noValidate\n        validated={validated}\n        onSubmit={(e) => handleSubmit(e)}\n        onReset={(e) => handleCloseForm(e)}\n      >\n        <div>\n          <Form.Group className=\"mb-3\" controlId=\"formReceiver\">\n            {!isCreating ? (\n              <div></div>\n            ) : (\n              <div>\n                <Form.Label>Goal Title </Form.Label>\n                <Form.Control\n                  required\n                  type=\"text\"\n                  placeholder=\"Enter the title\"\n                />\n              </div>\n            )}\n\n            <Form.Control.Feedback type=\"invalid\">\n              Please enter a receiver.\n            </Form.Control.Feedback>\n            <Form.Text></Form.Text>\n          </Form.Group>\n        </div>\n        <Form.Group className=\"mb-3\" controlId=\"formAmount\">\n          <Form.Label>Amount</Form.Label>\n          <InputGroup className=\"mb-3\">\n            <InputGroup.Text>$</InputGroup.Text>\n            {!isCreating ? (\n              <FormControl\n                required\n                type=\"number\"\n                min=\"0.00\"\n                max=\"10000.00\"\n                step=\"0.01\"\n                placeholder=\"Enter amount\"\n                defaultValue={amount}\n              />\n            ) : (\n              <FormControl\n                required\n                type=\"number\"\n                min=\"0.00\"\n                max=\"10000.00\"\n                step=\"0.01\"\n                placeholder=\"Enter amount\"\n              />\n            )}\n\n            <Form.Control.Feedback type=\"invalid\">\n              Please enter a amount.\n            </Form.Control.Feedback>\n          </InputGroup>\n        </Form.Group>\n        <div>\n          <Form.Group className=\"mb-3\" controlId=\"formSaved\">\n            <Form.Label>Saved</Form.Label>\n            <InputGroup className=\"mb-3\">\n              <InputGroup.Text>$</InputGroup.Text>\n              {!isCreating ? (\n                <FormControl\n                  required\n                  type=\"number\"\n                  min=\"0.00\"\n                  max=\"10000.00\"\n                  step=\"0.01\"\n                  placeholder=\"Enter amount saved\"\n                  defaultValue={saved}\n                />\n              ) : (\n                <FormControl\n                  required\n                  type=\"number\"\n                  min=\"0.00\"\n                  max=\"10000.00\"\n                  step=\"0.01\"\n                  placeholder=\"Enter amount saved\"\n                />\n              )}\n\n              <Form.Control.Feedback type=\"invalid\">\n                Please enter a amount saved.\n              </Form.Control.Feedback>\n            </InputGroup>\n          </Form.Group>\n        </div>\n        <div>\n          <Form.Group className=\"mb-3\" controlId=\"formDate\">\n            <Form.Label>Date </Form.Label>\n            <Form.Control\n              required\n              type=\"date\"\n              max={moment().format(\"YYYY-MM-DD\")}\n              placeholder=\"Enter the date\"\n            />\n            <Form.Control.Feedback type=\"invalid\">\n              Please choose a date.\n            </Form.Control.Feedback>\n            <Form.Text></Form.Text>\n          </Form.Group>\n        </div>\n        <div>\n          <div className=\"d-flex justify-content-center\">\n            <Button size=\"md\" variant=\"primary\" type=\"submit\">\n              {isCreating ? \"Add Goal\" : \"Edit Goal\"}\n            </Button>\n          </div>\n        </div>\n      </Form>\n    </div>\n  );\n};\n\nexport default CreateEditGoalForm;\n"]},"metadata":{},"sourceType":"module"}
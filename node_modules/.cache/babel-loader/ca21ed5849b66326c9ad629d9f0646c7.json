{"ast":null,"code":"import _asyncToGenerator from\"/Users/javier/Documents/BudgetFrontend/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/javier/Documents/BudgetFrontend/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/javier/Documents/BudgetFrontend/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useContext}from\"react\";import{Form,Button,Modal,InputGroup,FormControl,OverlayTrigger,Tooltip}from\"react-bootstrap\";import AuthContext from\"../../Context/AuthContext\";import{useNavigate}from\"react-router-dom\";import moment from\"moment\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CreateEditGoalForm=function CreateEditGoalForm(_ref){var creating=_ref.creating,title=_ref.title,amount=_ref.amount,saved=_ref.saved,idGoal=_ref.idGoal;var _useState=useState(creating),_useState2=_slicedToArray(_useState,2),isCreating=_useState2[0],setIsCreating=_useState2[1];var _useContext=useContext(AuthContext),authTokens=_useContext.authTokens,logoutUser=_useContext.logoutUser;var history=useNavigate();var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),validated=_useState4[0],setValidated=_useState4[1];var createTransactionForGoal=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var amountToSave,transacWay,response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:amountToSave=event.target.elements.formSaved.value;transacWay=\"O\";if(!creating){if(parseFloat(event.target.elements.formSaved.value)>parseFloat(saved)){amountToSave=event.target.elements.formSaved.value-saved;}else if(parseFloat(event.target.elements.formSaved.value)<parseFloat(saved)){amountToSave=saved-event.target.elements.formSaved.value;transacWay=\"I\";}}_context.next=5;return fetch(\"/transactions/create/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+String(authTokens.access)},body:JSON.stringify({amount:amountToSave,category:\"goal\",receiver:title,transaction_way:transacWay,date:event.target.elements.formDate.value})});case 5:response=_context.sent;_context.next=8;return response.json();case 8:data=_context.sent;if(response.statusText===\"Unauthorized\"){logoutUser();}return _context.abrupt(\"return\");case 11:case\"end\":return _context.stop();}}},_callee);}));return function createTransactionForGoal(_x){return _ref2.apply(this,arguments);};}();var createGoal=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"/goals/create/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+String(authTokens.access)},body:JSON.stringify({amount:event.target.elements.formAmount.value,saved:event.target.elements.formSaved.value,title:event.target.elements.formReceiver.value})});case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:data=_context2.sent;if(!(response.status===200)){_context2.next=11;break;}_context2.next=9;return createTransactionForGoal(event);case 9:_context2.next=12;break;case 11:if(response.statusText===\"Unauthorized\"){logoutUser();}case 12:window.location.reload();case 13:case\"end\":return _context2.stop();}}},_callee2);}));return function createGoal(_x2){return _ref3.apply(this,arguments);};}();var editGoal=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(parseFloat(event.target.elements.formSaved.value)>parseFloat(event.target.elements.formAmount.value))){_context3.next=3;break;}alert(\"Saved can't be greater than amount\");return _context3.abrupt(\"return\");case 3:_context3.next=5;return fetch(\"/goals/\".concat(idGoal,\"/update/\"),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+String(authTokens.access)},body:JSON.stringify({amount:event.target.elements.formAmount.value,saved:event.target.elements.formSaved.value,title:title})});case 5:response=_context3.sent;if(!(response.status===200)){_context3.next=12;break;}if(!(event.target.elements.formSaved.value!==saved||event.target.elements.formAmount.value!==amount)){_context3.next=10;break;}_context3.next=10;return createTransactionForGoal(event);case 10:_context3.next=13;break;case 12:if(response.statusText===\"Unauthorized\"){logoutUser();}case 13:window.location.reload();case 14:case\"end\":return _context3.stop();}}},_callee3);}));return function editGoal(_x3){return _ref4.apply(this,arguments);};}();var handleSubmit=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(event){var form;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:form=event.currentTarget;if(form.checkValidity()===false){event.preventDefault();event.stopPropagation();alert(\"No changes detected\");}else{if(isCreating){createGoal(event);}else{editGoal(event);event.preventDefault();event.stopPropagation();}}setValidated(true);handleCloseForm();case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function handleSubmit(_x4){return _ref5.apply(this,arguments);};}();var handleCloseForm=function handleCloseForm(event){//event.preventDefault();\n//event.stopPropagation();\nsetValidated(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"w-100\",children:/*#__PURE__*/_jsxs(Form,{noValidate:true,validated:validated,onSubmit:function onSubmit(e){return handleSubmit(e);},onReset:function onReset(e){return handleCloseForm(e);},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formReceiver\",children:[!isCreating?/*#__PURE__*/_jsx(\"div\",{}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Goal Title \"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"text\",placeholder:\"Enter the title\"})]}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please enter a receiver.\"}),/*#__PURE__*/_jsx(Form.Text,{})]})}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formAmount\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Amount\"}),/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(InputGroup.Text,{children:\"$\"}),!isCreating?/*#__PURE__*/_jsx(FormControl,{required:true,type:\"number\",min:\"0.00\",max:\"10000.00\",step:\"0.01\",placeholder:\"Enter amount\",defaultValue:amount}):/*#__PURE__*/_jsx(FormControl,{required:true,type:\"number\",min:\"0.00\",max:\"10000.00\",step:\"0.01\",placeholder:\"Enter amount\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please enter a amount.\"})]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formSaved\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Saved\"}),/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(InputGroup.Text,{children:\"$\"}),!isCreating?/*#__PURE__*/_jsx(FormControl,{required:true,type:\"number\",min:\"0.00\",max:\"10000.00\",step:\"0.01\",placeholder:\"Enter amount saved\",defaultValue:saved}):/*#__PURE__*/_jsx(FormControl,{required:true,type:\"number\",min:\"0.00\",max:\"10000.00\",step:\"0.01\",placeholder:\"Enter amount saved\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please enter a amount saved.\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formDate\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date \"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"date\",max:moment().format(\"YYYY-MM-DD\"),placeholder:\"Enter the date\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please choose a date.\"}),/*#__PURE__*/_jsx(Form.Text,{})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(Button,{size:\"md\",variant:\"primary\",type:\"submit\",children:isCreating?\"Add Goal\":\"Edit Goal\"})})})]})});};export default CreateEditGoalForm;","map":{"version":3,"sources":["/Users/javier/Documents/BudgetFrontend/frontend/src/Components/Forms/CreateEditGoalForm.js"],"names":["React","useState","useContext","Form","Button","Modal","InputGroup","FormControl","OverlayTrigger","Tooltip","AuthContext","useNavigate","moment","CreateEditGoalForm","creating","title","amount","saved","idGoal","isCreating","setIsCreating","authTokens","logoutUser","history","validated","setValidated","createTransactionForGoal","event","amountToSave","target","elements","formSaved","value","transacWay","parseFloat","fetch","method","headers","Authorization","String","access","body","JSON","stringify","category","receiver","transaction_way","date","formDate","response","json","data","statusText","createGoal","formAmount","formReceiver","status","window","location","reload","editGoal","alert","handleSubmit","form","currentTarget","checkValidity","preventDefault","stopPropagation","handleCloseForm","e","format"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from \"react\";\nimport {\n  Form,\n  Button,\n  Modal,\n  InputGroup,\n  FormControl,\n  OverlayTrigger,\n  Tooltip,\n} from \"react-bootstrap\";\nimport AuthContext from \"../../Context/AuthContext\";\nimport { useNavigate } from \"react-router-dom\";\nimport moment from \"moment\";\n\nconst CreateEditGoalForm = ({ creating, title, amount, saved, idGoal }) => {\n  const [isCreating, setIsCreating] = useState(creating);\n  let { authTokens, logoutUser } = useContext(AuthContext);\n  const history = useNavigate();\n\n  const [validated, setValidated] = useState(false);\n\n  const createTransactionForGoal = async (event) => {\n    let amountToSave = event.target.elements.formSaved.value;\n    let transacWay = \"O\";\n    if (!creating) {\n      if (\n        parseFloat(event.target.elements.formSaved.value) > parseFloat(saved)\n      ) {\n        amountToSave = event.target.elements.formSaved.value - saved;\n      } else if (\n        parseFloat(event.target.elements.formSaved.value) < parseFloat(saved)\n      ) {\n        amountToSave = saved - event.target.elements.formSaved.value;\n        transacWay = \"I\";\n      }\n    }\n    let response = await fetch(\"/transactions/create/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + String(authTokens.access),\n      },\n      body: JSON.stringify({\n        amount: amountToSave,\n        category: \"goal\",\n        receiver: title,\n        transaction_way: transacWay,\n        date: event.target.elements.formDate.value,\n      }),\n    });\n    let data = await response.json();\n    if (response.statusText === \"Unauthorized\") {\n      logoutUser();\n    }\n    return;\n  };\n\n  const createGoal = async (event) => {\n    let response = await fetch(\"/goals/create/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + String(authTokens.access),\n      },\n      body: JSON.stringify({\n        amount: event.target.elements.formAmount.value,\n        saved: event.target.elements.formSaved.value,\n        title: event.target.elements.formReceiver.value,\n      }),\n    });\n    let data = await response.json();\n    if (response.status === 200) {\n      //history(\"/\");\n      await createTransactionForGoal(event);\n    } else if (response.statusText === \"Unauthorized\") {\n      logoutUser();\n    }\n    window.location.reload();\n  };\n\n  const editGoal = async (event) => {\n    if (\n      parseFloat(event.target.elements.formSaved.value) >\n      parseFloat(event.target.elements.formAmount.value)\n    ) {\n      alert(\"Saved can't be greater than amount\");\n      return;\n    }\n    let response = await fetch(`/goals/${idGoal}/update/`, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + String(authTokens.access),\n      },\n      body: JSON.stringify({\n        amount: event.target.elements.formAmount.value,\n        saved: event.target.elements.formSaved.value,\n        title: title,\n      }),\n    });\n    if (response.status === 200) {\n      //history(\"/\");\n      if (\n        event.target.elements.formSaved.value !== saved ||\n        event.target.elements.formAmount.value !== amount\n      ) {\n        await createTransactionForGoal(event);\n      }\n    } else if (response.statusText === \"Unauthorized\") {\n      logoutUser();\n    }\n    window.location.reload();\n  };\n\n  const handleSubmit = async (event) => {\n    const form = event.currentTarget;\n    if (form.checkValidity() === false) {\n      event.preventDefault();\n      event.stopPropagation();\n      alert(\"No changes detected\");\n    } else {\n      if (isCreating) {\n        createGoal(event);\n      } else {\n        editGoal(event);\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }\n    setValidated(true);\n    handleCloseForm();\n  };\n\n  const handleCloseForm = (event) => {\n    //event.preventDefault();\n    //event.stopPropagation();\n    setValidated(false);\n  };\n\n  return (\n    <div className=\"w-100\">\n      <Form\n        noValidate\n        validated={validated}\n        onSubmit={(e) => handleSubmit(e)}\n        onReset={(e) => handleCloseForm(e)}\n      >\n        <div>\n          <Form.Group className=\"mb-3\" controlId=\"formReceiver\">\n            {!isCreating ? (\n              <div></div>\n            ) : (\n              <div>\n                <Form.Label>Goal Title </Form.Label>\n                <Form.Control\n                  required\n                  type=\"text\"\n                  placeholder=\"Enter the title\"\n                />\n              </div>\n            )}\n\n            <Form.Control.Feedback type=\"invalid\">\n              Please enter a receiver.\n            </Form.Control.Feedback>\n            <Form.Text></Form.Text>\n          </Form.Group>\n        </div>\n        <Form.Group className=\"mb-3\" controlId=\"formAmount\">\n          <Form.Label>Amount</Form.Label>\n          <InputGroup className=\"mb-3\">\n            <InputGroup.Text>$</InputGroup.Text>\n            {!isCreating ? (\n              <FormControl\n                required\n                type=\"number\"\n                min=\"0.00\"\n                max=\"10000.00\"\n                step=\"0.01\"\n                placeholder=\"Enter amount\"\n                defaultValue={amount}\n              />\n            ) : (\n              <FormControl\n                required\n                type=\"number\"\n                min=\"0.00\"\n                max=\"10000.00\"\n                step=\"0.01\"\n                placeholder=\"Enter amount\"\n              />\n            )}\n\n            <Form.Control.Feedback type=\"invalid\">\n              Please enter a amount.\n            </Form.Control.Feedback>\n          </InputGroup>\n        </Form.Group>\n        <div>\n          <Form.Group className=\"mb-3\" controlId=\"formSaved\">\n            <Form.Label>Saved</Form.Label>\n            <InputGroup className=\"mb-3\">\n              <InputGroup.Text>$</InputGroup.Text>\n              {!isCreating ? (\n                <FormControl\n                  required\n                  type=\"number\"\n                  min=\"0.00\"\n                  max=\"10000.00\"\n                  step=\"0.01\"\n                  placeholder=\"Enter amount saved\"\n                  defaultValue={saved}\n                />\n              ) : (\n                <FormControl\n                  required\n                  type=\"number\"\n                  min=\"0.00\"\n                  max=\"10000.00\"\n                  step=\"0.01\"\n                  placeholder=\"Enter amount saved\"\n                />\n              )}\n\n              <Form.Control.Feedback type=\"invalid\">\n                Please enter a amount saved.\n              </Form.Control.Feedback>\n            </InputGroup>\n          </Form.Group>\n        </div>\n        <div>\n          <Form.Group className=\"mb-3\" controlId=\"formDate\">\n            <Form.Label>Date </Form.Label>\n            <Form.Control\n              required\n              type=\"date\"\n              max={moment().format(\"YYYY-MM-DD\")}\n              placeholder=\"Enter the date\"\n            />\n            <Form.Control.Feedback type=\"invalid\">\n              Please choose a date.\n            </Form.Control.Feedback>\n            <Form.Text></Form.Text>\n          </Form.Group>\n        </div>\n        <div>\n          <div className=\"d-flex justify-content-center\">\n            <Button size=\"md\" variant=\"primary\" type=\"submit\">\n              {isCreating ? \"Add Goal\" : \"Edit Goal\"}\n            </Button>\n          </div>\n        </div>\n      </Form>\n    </div>\n  );\n};\n\nexport default CreateEditGoalForm;\n"]},"metadata":{},"sourceType":"module"}